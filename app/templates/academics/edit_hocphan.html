{% extends "base.html" %}

{% block title %}S·ª≠a H·ªçc ph·∫ßn{% endblock %}

{% block content %}
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
  <h2>‚úèÔ∏è S·ª≠a th√¥ng tin h·ªçc ph·∫ßn</h2>
  <a href="/academics/hocphan/list" class="btn btn-secondary">‚Ü©Ô∏è Quay l·∫°i danh s√°ch</a>
</div>

<!-- Form s·ª≠a h·ªçc ph·∫ßn -->
<div
  style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); max-width: 800px;">
  <form method="POST" style="display: grid; gap: 20px;">
    <!-- M√£ h·ªçc ph·∫ßn (readonly) -->
    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 15px; align-items: center;">
      <label style="font-weight: 500; color: #495057;">M√£ h·ªçc ph·∫ßn:</label>
      <input type="text" value="{{ hocphan.ma_hp }}" readonly
        style="padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px; background: #f8f9fa; color: #6c757d;">
      <input type="hidden" name="ma_hp" value="{{ hocphan.ma_hp }}">
    </div>

    <!-- T√™n h·ªçc ph·∫ßn -->
    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 15px; align-items: center;">
      <label style="font-weight: 500; color: #495057;">
        <span style="color: red;">*</span> T√™n h·ªçc ph·∫ßn:
      </label>
      <input type="text" name="ten_hp" value="{{ hocphan.ten_hp }}" required
        placeholder="VD: To√°n cao c·∫•p, V·∫≠t l√Ω ƒë·∫°i c∆∞∆°ng..."
        style="padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;">
    </div>

    <!-- S·ªë ƒêVHT -->
    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 15px; align-items: center;">
      <label style="font-weight: 500; color: #495057;">S·ªë t√≠n ch·ªâ (ƒêVHT):</label>
      <select name="so_dvht" style="padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;">
        <option value="">-- Ch·ªçn s·ªë t√≠n ch·ªâ --</option>
        <option value="1" {% if hocphan.so_dvht==1 %}selected{% endif %}>1 t√≠n ch·ªâ</option>
        <option value="2" {% if hocphan.so_dvht==2 %}selected{% endif %}>2 t√≠n ch·ªâ</option>
        <option value="3" {% if hocphan.so_dvht==3 %}selected{% endif %}>3 t√≠n ch·ªâ</option>
        <option value="4" {% if hocphan.so_dvht==4 %}selected{% endif %}>4 t√≠n ch·ªâ</option>
        <option value="5" {% if hocphan.so_dvht==5 %}selected{% endif %}>5 t√≠n ch·ªâ</option>
        <option value="6" {% if hocphan.so_dvht==6 %}selected{% endif %}>6 t√≠n ch·ªâ</option>
      </select>
    </div>

    <!-- Ng√†nh -->
    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 15px; align-items: center;">
      <label style="font-weight: 500; color: #495057;">
        <span style="color: red;">*</span> Ng√†nh:
      </label>
      <select name="ma_nganh" required
        style="padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;">
        <option value="">-- Ch·ªçn ng√†nh --</option>
        {% for nganh in nganhs %}
        <option value="{{ nganh.ma_nganh }}" {% if hocphan.ma_nganh==nganh.ma_nganh %}selected{% endif %}>
          {{ nganh.ten_nganh }} ({{ nganh.khoa.ten_khoa }})
        </option>
        {% endfor %}
      </select>
    </div>

    <!-- H·ªçc k·ª≥ -->
    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 15px; align-items: center;">
      <label style="font-weight: 500; color: #495057;">H·ªçc k·ª≥:</label>
      <select name="hoc_ky" style="padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;">
        <option value="">-- Ch·ªçn h·ªçc k·ª≥ --</option>
        <option value="1" {% if hocphan.hoc_ky==1 %}selected{% endif %}>H·ªçc k·ª≥ 1</option>
        <option value="2" {% if hocphan.hoc_ky==2 %}selected{% endif %}>H·ªçc k·ª≥ 2</option>
        <option value="3" {% if hocphan.hoc_ky==3 %}selected{% endif %}>H·ªçc k·ª≥ 3</option>
        <option value="4" {% if hocphan.hoc_ky==4 %}selected{% endif %}>H·ªçc k·ª≥ 4</option>
        <option value="5" {% if hocphan.hoc_ky==5 %}selected{% endif %}>H·ªçc k·ª≥ 5</option>
        <option value="6" {% if hocphan.hoc_ky==6 %}selected{% endif %}>H·ªçc k·ª≥ 6</option>
        <option value="7" {% if hocphan.hoc_ky==7 %}selected{% endif %}>H·ªçc k·ª≥ 7</option>
        <option value="8" {% if hocphan.hoc_ky==8 %}selected{% endif %}>H·ªçc k·ª≥ 8</option>
      </select>
    </div>

    <!-- Buttons -->
    <div
      style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px; padding-top: 20px; border-top: 1px solid #eee;">
      <a href="/academics/hocphan/list" class="btn btn-secondary">‚ùå H·ªßy</a>
      <button type="submit" class="btn btn-primary">üíæ L∆∞u thay ƒë·ªïi</button>
    </div>
  </form>
</div>

<!-- Th√¥ng tin hi·ªán t·∫°i -->
<div style="margin-top: 30px; padding: 20px; background: #e3f2fd; border-radius: 10px; border-left: 4px solid #2196f3;">
  <h5 style="color: #1976d2; margin-bottom: 15px;">üìã Th√¥ng tin hi·ªán t·∫°i</h5>
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
    <div>
      <strong>M√£ HP:</strong> {{ hocphan.ma_hp }}
    </div>
    <div>
      <strong>T√™n:</strong> {{ hocphan.ten_hp }}
    </div>
    <div>
      <strong>T√≠n ch·ªâ:</strong> {{ hocphan.so_dvht or 'Ch∆∞a x√°c ƒë·ªãnh' }}
    </div>
    <div>
      <strong>Ng√†nh:</strong>
      {% if hocphan.nganh %}
      {{ hocphan.nganh.ten_nganh }}
      {% else %}
      Ch∆∞a x√°c ƒë·ªãnh
      {% endif %}
    </div>
    <div>
      <strong>H·ªçc k·ª≥:</strong> {{ hocphan.hoc_ky or 'Ch∆∞a x√°c ƒë·ªãnh' }}
    </div>
  </div>
</div>

<!-- C·∫£nh b√°o -->
<div style="margin-top: 20px; padding: 15px; background: #fff3cd; border-radius: 8px; border-left: 4px solid #ffc107;">
  <h6 style="color: #856404; margin-bottom: 8px;">‚ö†Ô∏è L∆∞u √Ω</h6>
  <p style="color: #856404; margin: 0; font-size: 14px;">
    Thay ƒë·ªïi th√¥ng tin h·ªçc ph·∫ßn c√≥ th·ªÉ ·∫£nh h∆∞·ªüng ƒë·∫øn ƒëi·ªÉm s·ªë c·ªßa sinh vi√™n ƒë√£ h·ªçc m√¥n n√†y.
  </p>
</div>

<script>
  // Validation client-side
  document.querySelector('form').addEventListener('submit', function (e) {
    const tenHp = document.querySelector('input[name="ten_hp"]').value.trim();
    const maNganh = document.querySelector('select[name="ma_nganh"]').value;

    if (!tenHp || !maNganh) {
      e.preventDefault();
      alert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin b·∫Øt bu·ªôc (*)');
      return;
    }
  });
</script>
{% endblock %}